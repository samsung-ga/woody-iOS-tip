### Today I Learned

----

2022.10.07 (금)

<br />

내일 카카오 2차 코딩테스트를 위해  [2022 카카오 블라인드 2차 과제](https://programmers.co.kr/app/with_setting/tests/34404/challenges)를 풀었습니다. 

API 통신을 통해 게임유저 MMR을 조절하여 비슷한 실력의 유저끼리 매칭시키는 알고리즘을 구현하는 문제입니다. 작년도에 풀었을 당시엔, 환경을 일반 Command Line Tool을 이용했기 때문에 세마포어를 이용해서 콜백 지옥을 해결했습니다. 하지만 이번엔 iOS Application으로 구현하여  async await을 이용한 통신으로 구현했습니다. parser도 라이브러리를 사용할 수는 있지만 코테 때 어떤 문제가 나올지 모르기때문에 라이브러리는 따로 사용하지 않았습니다. 

----

시나리오 1의 문제 점수에 영향을 미치는 것은 총 세개입니다. MMR이 비슷한 유저끼리 매칭되기, 유저의 MMR이 고유 실력 순위와 일치하게 만들기, 그리고 매칭을 신청한 유저가 기다린 시간을 최소화하기. 가장 먼저 접근한 방식은 그냥 구현하기 였습니다. 먼저 유저들의 MMR을 모두 5000으로 초기화해주었습니다. 그리고 대기 유저 리스트에 들어오는 순서대로 매칭시키고 대결 결과에서 이긴 유저는 1을 더하고 진 유저는 1을 뺐습니다. 간단한 구현을 통해서 186.8761점을 획득할 수 있습니다. 

<img width="1161" alt="결과 1" src="https://user-images.githubusercontent.com/56102421/194541577-26b03296-2e71-4d19-a922-ae5cc82b4970.png">

일반적으로 점수를 높일 수 있는 방법은 비슷한 MMR을 가진 유저끼리 매칭하는 것입니다. 대기 유저가 있는 경우 유저의 MMR 정보를 가져와 차이가 가장 적은 MMR을 가진 유저끼리 매칭하면 198.7717점을 획득할 수 있습니다. 정말 미미한 점수차이지만 12점을 올릴 수 있습니다. 

<img width="1168" alt="결과 2" src="https://user-images.githubusercontent.com/56102421/194541505-88141ff4-db4b-4d1f-9aa8-6d4113d57727.png">

다음 생각할 수 있는 방법은 대결 결과에서 승자와 패자에게 더하고 뺴는 가중치를 조절하는 방식입니다. 문제에서 대결시간과 승자와 패자의 MMR 차이의 관계가 주어져있습니다. 대결시간이 클 수록 MMR이 비슷한 유저들의 대결이고 대결시간이 작을 수록 MMR 차이가 큰 유저들의 대결입니다. 따라서, (40 - 대결 시간) * E를 가중치로 계산합니다. (40은 대결의 최대 시간이 40입니다.) 여기서 E가 관건이었는데 처음엔 2.5로 계산했더니 220.6579점을 획득했습니다. 하지만 35.5로 계산하 235.9379점을 획득할 수 있습니다. E의 값을 정확히 어떻게 구하는지는 모르겠지만 조절하며 알고리즘을 수정했습니다. 

<img width="1166" alt="결과 4" src="https://user-images.githubusercontent.com/56102421/194541514-663af54c-9bbf-48db-958b-ec4d9ce8460e.png">

유저가 대기하는 시간은 고려를 하지 않았습니다. 아니. 고려를 하긴 했습니다. 10분 대기를 한 유저만 매칭을 했더니 점수가 178점으로  줄었습니다. 그래서 대기 리스트에 올라오는 유저를 바로바로 매칭시켰습니다.  

시나리오 2의 어뷰저 처리는 대결 시간이 10분 이하인 유저들의 대결을 전부 배제시켰습니다. 이 문제는 시뮬레이션을 한번 돌리는데 너무 오래 걸려 끝까지 돌려보진 못했습니다만 정확도가 조금 높아졌을 거라 예상합니다. 

<img width="1148" alt="문제 2 -결과 1" src="https://user-images.githubusercontent.com/56102421/194541520-d523d518-3aba-4778-9603-bcd4d7d51199.png">

문제를 다 풀고 [안즈님](https://anz1217.tistory.com/140?category=799868)의 블로그를 읽고 가중치 조절에 대해 더 아이디어를 얻을 수 있었습니다. A와 B의 대결에서 A가 승리했다고 해보면, (기존 A의 MMR - 기존 B의 MMR)이 작을수록 가중치 변동을 크게 합니다. 더 실력이 높은 상대일수록 이를 이긴 유저의 MMR은 높을 가능성이 크고, 반대로 실력이 낮은 상대일수록 이에 진 유저의 MMR은 낮을 가능성이 크기 떄문입니다. 또 한가지 진행된 게임 시간이 짧을수록 가중치를 더 커지도록 합니다. 게임 시간이 짧을수록 두 유저의 실력차가 클 가능성이 크기 때문입니다. 가중치를 매 경기 결과마다 조절하면서 풀면 점수가 더 높게 나올 것이라고 생각합니다. 😓

----

총 414점을 획득했네요. ㅠ 더 높이고 싶습니다. 내일도 화이팅!